C51 COMPILER V9.54   SELFLEARN                                                             04/01/2016 10:06:43 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE SELFLEARN
OBJECT MODULE PLACED IN .\Objects\Selflearn.obj
COMPILER INVOKED BY: D:\Program Files (x86)\Keil_v5\C51\BIN\C51.EXE Selflearn.c ROM(COMPACT) OPTIMIZE(8,SPEED) BROWSE DE
                    -BUG OBJECTEXTEND PRINT(.\Listings\Selflearn.lst) TABS(3) OBJECT(.\Objects\Selflearn.obj)

line level    source

   1          /*------------------------------------------------------------------*-
   2             A.C (v1.00)
   3            ------------------------------------------------------------------
   4             Simple switch interface code, with software debounce.
   5          
   6             COPYRIGHT
   7             ---------
   8             This code is copyright (c) 2001 by Richard Zhang.
   9          -*------------------------------------------------------------------*/
  10          
  11          #include "Main.h"
  12          #include "Port.h"
  13          
  14          #include "Selflearn.h"
  15          #include "Speech.h"
  16          #include "ISP_DataFlash.h"
  17          #include "UART.h"
  18          
  19          // ------ Public variable definitions ------------------------------
  20          
  21          // ------ Public variable declarations -----------------------------
  22          extern bit Received_finished_G;
  23          extern tByte Received_cache[7];
  24          
  25          // ------ Private variables ----------------------------------------
  26          
  27          // ------ Private constants ----------------------------------------
  28          
  29          /*------------------------------------------------------------------*-
  30            Selflearn_Init()
  31            Initialisation function for the switch library.
  32          -*------------------------------------------------------------------*/
  33          void Selflearn_Init(void)
  34             {
  35   1         // Set P0.3(Passwd_reed_switch_port) to input mode.
  36   1         P2M1 |= 0x20;
  37   1         P2M2 &= 0xdf;
  38   1         }
  39          
  40          
  41          /*------------------------------------------------------------------*-
  42            Self_learn_action()
  43            Initialisation function for the switch library.
  44          -*------------------------------------------------------------------*/
  45          void Self_learn_action(void)
  46             {
  47   1         if((!Passwd_reed_switch_port)&&(Received_finished_G))
  48   1            {
  49   2            Goto_speech(Ticktack);
  50   2            Self_learn_programming();
  51   2            Received_finished_G = 0;
  52   2            }
  53   1         }
  54          
C51 COMPILER V9.54   SELFLEARN                                                             04/01/2016 10:06:43 PAGE 2   

  55          /*------------------------------------------------------------------*-
  56            Self_learn_programming()
  57            Initialisation function for the switch library.
  58          -*------------------------------------------------------------------*/
  59          void Self_learn_programming(void)
  60             {
  61   1         Flash_Page_Erase(0x3000);
  62   1         Flash_Write_Data(0x3000, Received_cache[5]);    
  63   1         Flash_Write_Data(0x3001, Received_cache[4]);    
  64   1         Flash_Write_Data(0x3002, Received_cache[3]);    
  65   1         Flash_Write_Data(0x3003, Received_cache[2]);    
  66   1         Flash_Write_Data(0x3004, Received_cache[1]);
  67   1         Flash_Write_Data(0x3005, Received_cache[0]);
  68   1         
  69   1         }
  70          
  71          /*------------------------------------------------------------------*-
  72            ---- END OF FILE -------------------------------------------------
  73          -*------------------------------------------------------------------*/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     85    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
