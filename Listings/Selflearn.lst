C51 COMPILER V9.54   SELFLEARN                                                             04/22/2016 14:54:24 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE SELFLEARN
OBJECT MODULE PLACED IN .\Objects\Selflearn.obj
COMPILER INVOKED BY: D:\Program Files (x86)\Keil_v5\C51\BIN\C51.EXE Selflearn.c ROM(COMPACT) OPTIMIZE(8,SPEED) BROWSE DE
                    -BUG OBJECTEXTEND PRINT(.\Listings\Selflearn.lst) TABS(3) OBJECT(.\Objects\Selflearn.obj)

line level    source

   1          /*------------------------------------------------------------------*-
   2             A.C (v1.00)
   3            ------------------------------------------------------------------
   4             Simple switch interface code, with software debounce.
   5          
   6             COPYRIGHT
   7             ---------
   8             This code is copyright (c) 2001 by Richard Zhang.
   9          -*------------------------------------------------------------------*/
  10          
  11          #include "Main.h"
  12          #include "Port.h"
  13          
  14          #include "Selflearn.h"
  15          #include "Speech.h"
  16          #include "ISP_DataFlash.h"
  17          #include "UART.h"
  18          #include "Receiver.h"
  19          
  20          // ------ Public variable definitions ------------------------------
  21          
  22          // ------ Public variable declarations -----------------------------
  23          extern bit Received_finished_G;
  24          extern tByte Received_cache[7];
  25          
  26          extern bit hSCH_sleep_EN;
  27          
  28          // ------ Private variables ----------------------------------------
  29          
  30          // ------ Private constants ----------------------------------------
  31          
  32          /*------------------------------------------------------------------*-
  33            Selflearn_Init()
  34            Initialisation function for the switch library.
  35          -*------------------------------------------------------------------*/
  36          void Selflearn_Init(void)
  37             {
  38   1         // Set P0.3(Passwd_reed_switch_port) to input mode.
  39   1         P2M1 |= 0x20;
  40   1         P2M2 &= 0xdf;
  41   1         }
  42          
  43          
  44          /*------------------------------------------------------------------*-
  45            Self_learn_action()
  46            Initialisation function for the switch library.
  47          -*------------------------------------------------------------------*/
  48          void Self_learn_action(void)
  49             {
  50   1         if(!Passwd_reed_switch_port)
  51   1            RXD_power_on();
  52   1      
  53   1         if((!Passwd_reed_switch_port)&&(Received_finished_G))
  54   1            {
C51 COMPILER V9.54   SELFLEARN                                                             04/22/2016 14:54:24 PAGE 2   

  55   2            Goto_speech(Ticktack);
  56   2            Self_learn_programming();
  57   2            Received_finished_G = 0;
  58   2            }
  59   1         }
  60          
  61          /*------------------------------------------------------------------*-
  62            Self_learn_programming()
  63            Initialisation function for the switch library.
  64          -*------------------------------------------------------------------*/
  65          void Self_learn_programming(void)
  66             {
  67   1         Flash_Page_Erase(0x3000);
  68   1         Flash_Write_Data(0x3000, Received_cache[5]);
  69   1         Flash_Write_Data(0x3001, Received_cache[4]);
  70   1         Flash_Write_Data(0x3002, Received_cache[3]);
  71   1         Flash_Write_Data(0x3003, Received_cache[2]);
  72   1         Flash_Write_Data(0x3004, Received_cache[1]);
  73   1         Flash_Write_Data(0x3005, Received_cache[0]);
  74   1         }
  75          
  76          /*------------------------------------------------------------------*-
  77            ---- END OF FILE -------------------------------------------------
  78          -*------------------------------------------------------------------*/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     91    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
